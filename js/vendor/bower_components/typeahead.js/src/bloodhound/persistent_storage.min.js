var PersistentStorage=(function(){var f;try{f=window.localStorage;f.setItem("~~~","!");f.removeItem("~~~")}catch(e){f=null}function c(i,h){this.prefix=["__",i,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+_.escapeRegExChars(this.prefix));this.ls=h||f;!this.ls&&this._noop()}_.mixin(c.prototype,{_prefix:function(h){return this.prefix+h},_ttlKey:function(h){return this._prefix(h)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=_.noop},_safeSet:function(h,j){try{this.ls.setItem(h,j)}catch(i){if(i.name==="QuotaExceededError"){this.clear();this._noop()}}},get:function(h){if(this.isExpired(h)){this.remove(h)}return g(this.ls.getItem(this._prefix(h)))},set:function(i,j,h){if(_.isNumber(h)){this._safeSet(this._ttlKey(i),d(b()+h))}else{this.ls.removeItem(this._ttlKey(i))}return this._safeSet(this._prefix(i),d(j))},remove:function(h){this.ls.removeItem(this._ttlKey(h));this.ls.removeItem(this._prefix(h));return this},clear:function(){var h,j=a(this.keyMatcher);for(h=j.length;h--;){this.remove(j[h])}return this},isExpired:function(i){var h=g(this.ls.getItem(this._ttlKey(i)));return _.isNumber(h)&&b()>h?true:false}});return c;function b(){return new Date().getTime()}function d(h){return JSON.stringify(_.isUndefined(h)?null:h)}function g(h){return $.parseJSON(h)}function a(j){var l,k,m=[],h=f.length;for(l=0;l<h;l++){if((k=f.key(l)).match(j)){m.push(k.replace(j,""))}}return m}})();