describe("options parser",function(){function c(d){return oParser(_.mixin({datumTokenizer:$.noop,queryTokenizer:$.noop},d||{}))}function b(d){return oParser({datumTokenizer:$.noop,queryTokenizer:$.noop,prefetch:_.mixin({url:"/example"},d||{})})}function a(d){return oParser({datumTokenizer:$.noop,queryTokenizer:$.noop,remote:_.mixin({url:"/example"},d||{})})}it("should throw exception if datumTokenizer is not set",function(){expect(d).toThrow();function d(){c({datumTokenizer:null})}});it("should throw exception if queryTokenizer is not set",function(){expect(d).toThrow();function d(){c({queryTokenizer:null})}});it("should wrap sorter",function(){var d=c({sorter:function(f,e){return f-e}});expect(d.sorter([2,1,3])).toEqual([1,2,3])});it("should default sorter to identity function",function(){var d=c();expect(d.sorter([2,1,3])).toEqual([2,1,3])});describe("local",function(){it("should default to empty array",function(){var d=c();expect(d.local).toEqual([])});it("should support function",function(){var d=c({local:function(){return[1]}});expect(d.local).toEqual([1])});it("should support arrays",function(){var d=c({local:[1]});expect(d.local).toEqual([1])})});describe("prefetch",function(){it("should throw exception if url is not set",function(){expect(d).toThrow();function d(){b({url:null})}});it("should support simple string format",function(){expect(c({prefetch:"/prefetch"}).prefetch).toBeDefined()});it("should default ttl to 1 day",function(){var d=b();expect(d.prefetch.ttl).toBe(86400000)});it("should default cache to true",function(){var d=b();expect(d.prefetch.cache).toBe(true)});it("should default transform to identiy function",function(){var d=b();expect(d.prefetch.transform("foo")).toBe("foo")});it("should default cacheKey to url",function(){var d=b();expect(d.prefetch.cacheKey).toBe(d.prefetch.url)});it("should default transport to jQuery.ajax",function(){var d=b();expect(d.prefetch.transport).toBe($.ajax)});it("should prepend verison to thumbprint",function(){var d=b();expect(d.prefetch.thumbprint).toBe("%VERSION%");d=b({thumbprint:"foo"});expect(d.prefetch.thumbprint).toBe("%VERSION%foo")});it("should wrap custom transport to be deferred compatible",function(){var h,d,e;h=b({transport:g});d=h.prefetch.transport("q");h=b({transport:f});e=h.prefetch.transport("q");waits(0);runs(function(){expect(d.isRejected()).toBe(true);expect(e.isResolved()).toBe(true)});function g(j,k,i){i()}function f(j,k,i){k()}})});describe("remote",function(){it("should throw exception if url is not set",function(){expect(d).toThrow();function d(){a({url:null})}});it("should support simple string format",function(){expect(c({remote:"/remote"}).remote).toBeDefined()});it("should default transform to identiy function",function(){var d=a();expect(d.remote.transform("foo")).toBe("foo")});it("should default transport to jQuery.ajax",function(){var d=a();expect(d.remote.transport).toBe($.ajax)});it("should default limiter to debouce",function(){var d=a();expect(d.remote.limiter.name).toBe("debounce")});it("should default prepare to identity function",function(){var d=a();expect(d.remote.prepare("q",{url:"/foo"})).toEqual({url:"/foo"})});it("should support wildcard for prepare",function(){var d=a({wildcard:"%FOO"});expect(d.remote.prepare("=",{url:"/%FOO"})).toEqual({url:"/%3D"})});it("should support replace for prepare",function(){var d=a({replace:function(){return"/bar"}});expect(d.remote.prepare("q",{url:"/foo"})).toEqual({url:"/bar"})});it("should should rateLimitBy for limiter",function(){var d=a({rateLimitBy:"throttle"});expect(d.remote.limiter.name).toBe("throttle")});it("should wrap custom transport to be deferred compatible",function(){var h,d,e;h=a({transport:g});d=h.remote.transport("q");h=a({transport:f});e=h.remote.transport("q");waits(0);runs(function(){expect(d.isRejected()).toBe(true);expect(e.isResolved()).toBe(true)});function g(j,k,i){i()}function f(j,k,i){k()}})})});